<ion-view title="Créer une alerte" id="tab-add-alert">

  <ion-content padding="true" data-ng-show="!AddAlertCtrl.showedMap">

    <form name="AddAlertCtrl.addForm" class="list" data-ng-if="! AddAlertCtrl.loaders.getPet">
      <button data-ng-if="! AddAlertCtrl.alert.photo" class="button button-block button-royal"
              data-ng-click="AddAlertCtrl.takePhoto()">
        <i class="ion-ios-camera"></i> Ajouter une photo
      </button>
      <label class="item item-input" data-ng-if="AddAlertCtrl.alert.photo"
             data-ng-click="AddAlertCtrl.takePhoto();">
        <img data-ng-src="{{AddAlertCtrl.alert.photo}}" width="50%" height="auto"
             style="display: block; margin-left: auto; margin-right: auto;" data-ng-click="AddAlertCtrl.takePhoto();">
      </label>
      <label class="item item-input item-select">
        <span class="input-label">Status</span>
        <select data-ng-model="AddAlertCtrl.alert.state"
                data-ng-options="state for state in AddAlertCtrl.states">
        </select>
      </label>
      <label class="item item-input">
        <div class="input-label">Nom</div>
        <input required type="text" required placeholder="Felix" data-ng-model="AddAlertCtrl.alert.pet.name">
      </label>
      <label class="item item-input">
        <div class="input-label">Date</div>
        <input type="date" placeholder="Date" data-ng-model="AddAlertCtrl.alert.date">
      </label>
      <label class="item item-input">
        <div class="input-label">Latitude</div>
        <span data-ng-bind="AddAlertCtrl.alert.position.lat"></span>
      </label>

      <label class="item item-input">
        <div class="input-label">Longitude</div>
        <span data-ng-bind="AddAlertCtrl.alert.position.lng"></span>
      </label>

      <label class="item item-input" data-ng-if="AddAlertCtrl.alert.pet.photo"
             data-ng-click="AddAlertCtrl.takePhoto();">
        <img ng-if="AddAlertCtrl.alert.pet.photos && AddAlertCtrl.alert.pet.photos.length"
             data-ng-src="{{AddAlertCtrl.alert.pet.photos[0]}}" height="auto"
             style="display: block; margin-left: auto; margin-right: auto;" data-ng-click="AddAlertCtrl.takePhoto();"/>

      </label>
      <div class="text-center" data-ng-if="AddAlertCtrl.loaders.species || AddAlertCtrl.loaders.breeds">
        <ion-spinner icon="lines"></ion-spinner>
      </div>
      <label class="item item-input item-select" data-ng-show="! AddAlertCtrl.loaders.species">
        <span class="input-label">Espèce</span>
        <img data-ng-if="AddAlertCtrl.alert.pet.species.image"
             ng-src="{{AddAlertCtrl.alert.pet.species.image}}" width="30" height="30"/>
        <select required data-ng-model="AddAlertCtrl.alert.pet.species" data-ng-change="AddAlertCtrl.getBreeds()"
                data-ng-options="species.name for species in AddAlertCtrl.species">
        </select>
      </label>

      <label class="item item-input item-select"
             data-ng-show="!AddAlertCtrl.loaders.breeds && AddAlertCtrl.breeds[AddAlertCtrl.alert.pet.species._id]">
        <span class="input-label">Race</span>
        <select required data-ng-model="AddAlertCtrl.alert.pet.breed"
                data-ng-options="breeds.name for breeds in AddAlertCtrl.breeds[AddAlertCtrl.alert.pet.species._id]">
        </select>
      </label>

      <label class="item item-input">
        <div class="input-label">Couleur</div>
        <input required type="text" placeholder="Noir" data-ng-model="AddAlertCtrl.alert.pet.color">
      </label>
      <label class="item item-input">
        <div class="input-label">Signes distinctifs</div>
        <input type="text" placeholder="Collier bleu" data-ng-model="AddAlertCtrl.alert.pet.particularity">
      </label>
      <label class="item item-input">
        <div class="input-label">Commentaire</div>
        <input type="text" placeholder="A l'air très apeuré" data-ng-model="AddAlertCtrl.alert.comment">
      </label>
      <button class="button button-balanced button-block"
              data-ng-disabled="AddAlertCtrl.addForm.$invalid || AddAlertCtrl.loaders.breeds || AddAlertCtrl.loaders.species"
              ng-click="AddAlertCtrl.addAlert()">
        <i class="ion-plus"></i>&nbsp
        Ajouter
      </button>
    </form>
    <button class="button button-balanced button-block"
            ng-click="AddAlertCtrl.showMap()">
      <i class="ion-location"></i>&nbsp;
      Voir la carte
    </button>

    <button class="button button-balanced button-block"
            ng-click="AddAlertCtrl.getLocalisation()">
      <i class="ion-location"></i>&nbsp;
      Position courante
    </button>


  </ion-content>
  <ion-content padding="true" data-ng-show="AddAlertCtrl.showedMap">
    <input type="text" data-ng-model="AddAlertCtrl.address">
    <button class="button button-balanced button-block"
            ng-click="AddAlertCtrl.geocodeAddress()">
      <i class="ion-search"></i>&nbsp;
      Chercher
    </button>

    <div width="100%" height="70%" ng-init="AddAlertCtrl.initMap()" id="map"></div>
    <button class="button button-balanced button-block"
            ng-click="AddAlertCtrl.hideMap()">
      <i class="ion-minus"></i>&nbsp;
      Cacher la carte
    </button>
  </ion-content>
</ion-view>
